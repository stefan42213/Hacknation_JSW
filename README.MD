Oto zaktualizowany i gotowy plik **README** uwzglÄ™dniajÄ…cy strukturÄ™ katalogÃ³w (`video/` i `data/`) oraz funkcjonalnoÅ›ci moduÅ‚Ã³w.

-----

# ğŸ¤– VisionBeltMonitor: System Monitorowania i Pomiaru TaÅ›my Produkcyjnej

VisionBeltMonitor to system wizyjny oparty na **OpenCV**, zaprojektowany do ciÄ…gÅ‚ego monitorowania, pomiaru szerokoÅ›ci elementÃ³w na taÅ›mie produkcyjnej oraz generowania alarmÃ³w w przypadku przestojÃ³w.

-----

## ğŸš€ Wprowadzenie i Kluczowe FunkcjonalnoÅ›ci

System automatycznie segmentuje strumieÅ„ wideo na logiczne sekcje produkcyjne, mierzy kaÅ¼dy element i generuje szczegÃ³Å‚owe statystyki oraz ostrzeÅ¼enia w czasie rzeczywistym.

  * **Precyzyjny Pomiar SzerokoÅ›ci:** Wykorzystuje zaawansowane przetwarzanie obrazu (`size.py`) do stabilnego okreÅ›lania szerokoÅ›ci elementu w pikselach.
  * **Segmentacja Sekcji:** Automatycznie wykrywa przejÅ›cia miÄ™dzy mierzonymi elementami/blokami (`sections.py`).
  * **Logowanie Statystyk:** Dla kaÅ¼dej wykrytej sekcji oblicza i zapisuje wartoÅ›ci **Min**, **Max** i **ÅšredniÄ…** szerokoÅ›Ä‡.
  * **Alarm STOP:** Monitoruje ruch i generuje alarm w przypadku dÅ‚uÅ¼szego braku aktywnoÅ›ci na taÅ›mie.

-----

## ğŸ› ï¸ Struktura Projektu i Instalacja

### 1\. Struktura FolderÃ³w

Projekt wymaga nastÄ™pujÄ…cej struktury katalogÃ³w do poprawnego dziaÅ‚ania:

```
/VisionBeltMonitor
â”œâ”€â”€ main.py Â  Â  Â  Â  # Logika gÅ‚Ã³wna, detekcja ruchu, I/O
â”œâ”€â”€ size.py Â  Â  Â  Â  # Klasa TapeMeasurer (Pomiar szerokoÅ›ci)
â”œâ”€â”€ sections.py Â  Â  # Klasa SectionDetector (Detekcja Å‚Ä…czeÅ„)
â”œâ”€â”€ /video Â  Â  Â  Â  Â # Å¹rÃ³dÅ‚a wideo
â”‚ Â  Â  â””â”€â”€ test2.mkv
â””â”€â”€ /data Â  Â  Â  Â  Â  # Katalog docelowy dla wszystkich plikÃ³w wynikowych
 Â  Â  Â  Â  â””â”€â”€ pomiary.txt
 Â  Â  Â  Â  â””â”€â”€ warning.txt
 Â  Â  Â  Â  â””â”€â”€ max_min_values.txt
```

### 2\. Wymagania

Wymagane biblioteki Python:

```bash
pip install opencv-python numpy
```

-----

## âš™ï¸ Konfiguracja (Plik `main.py`)

Zmienne konfiguracyjne okreÅ›lajÄ… Å›cieÅ¼ki do plikÃ³w, interwaÅ‚y logowania i czuÅ‚oÅ›Ä‡ alarmÃ³w:

| Zmienna | Opis | WartoÅ›Ä‡ |
| :--- | :--- | :--- |
| `VIDEO_SOURCE` | ÅšcieÅ¼ka do pliku wejÅ›ciowego. | `'video/test2.mkv'` |
| `DATA_DIR` | Folder wyjÅ›ciowy dla wszystkich logÃ³w. | `"data"` |
| `MEASUREMENT_LOG_INTERVAL` | InterwaÅ‚ zapisu surowego pomiaru do `pomiary.txt` (w sekundach). | `0.5` |
| `TIME_TO_WAIT_FOR_STOP` | Czas (w sekundach) braku ruchu, po ktÃ³rym uruchamiany jest alarm STOP. | `3.0` |

-----

## ğŸ§© Opis ModuÅ‚Ã³w

### `main.py` (Kierownik Zmiany)

Odpowiada za inicjalizacjÄ™, pÄ™tlÄ™ wideo, detekcjÄ™ ruchu i zarzÄ…dzanie logami.

  * **Inicjalizacja:** Uruchamia moduÅ‚y `TapeMeasurer` i `SectionDetector`. **Automatycznie tworzy folder `data/`**, jeÅ›li nie istnieje.
  * **Logowanie:** Wykorzystuje funkcje `log_data` i `save_section_stats` do zapisu wynikÃ³w do folderu `data/`.
  * **Alarm STOP:** PorÃ³wnuje klatki w skali szaroÅ›ci, aby wykryÄ‡ przestÃ³j taÅ›my.

### `size.py` (Klasa `TapeMeasurer`)

Odpowiada za dokÅ‚adny pomiar. Implementuje:

1.  **Maskowanie:** Przetwarzanie obrazu na binarnÄ… maskÄ™ (`get_mask()`).
2.  **Liniowy Skan:** Wykrywanie krawÄ™dzi taÅ›my na staÅ‚ej wysokoÅ›ci.
3.  **Stabilizacja:** WygÅ‚adzanie skokÃ³w pomiarowych, aby zapewniÄ‡ stabilny odczyt szerokoÅ›ci w czasie.

### `sections.py` (Klasa `SectionDetector`)

Odpowiada za segmentacjÄ™ produktu.

  * **Detekcja Å‚Ä…czeÅ„:** Analizuje lokalne gradienty (Sobel Y) w celu wykrycia ostrych, poziomych krawÄ™dzi symbolizujÄ…cych koniec sekcji.
  * **Cooldown:** Zapobiega wielokrotnemu wykrywaniu tego samego Å‚Ä…czenia, stabilizujÄ…c proces segmentacji.

-----

## ğŸ“Š Format PlikÃ³w Wynikowych (Wszystkie w `data/`)

### 1\. `pomiary.txt` (Surowe dane pomiarowe)

```
[2025-12-07 09:17:01];456
[2025-12-07 09:17:02];458
---section--- Â <-- Separator po wykryciu nowego bloku
[2025-12-07 09:17:03];312
```

### 2\. `max_min_values.txt` (Statystyki sekcji)

```
[09:17:03] Sekcja 1 -> MIN: 456.00 | MAX: 460.00 | Åšrednia: 457.92
[09:17:05] Sekcja 2 -> MIN: 310.00 | MAX: 318.00 | Åšrednia: 314.55
```

### 3\. `warning.txt` (Alarmy systemowe)

```
[2025-12-07 09:20:30] OSTRZEZENIE: TaÅ›ma produkcyjna zatrzymana!
```

-----

## â–¶ï¸ Uruchomienie

Uruchom gÅ‚Ã³wny skrypt z katalogu gÅ‚Ã³wnego projektu:

```bash
python main.py
```

WyjÅ›cie z programu nastÄ™puje po wciÅ›niÄ™ciu klawisza **`q`** w oknie podglÄ…du. Po zakoÅ„czeniu, system zapisze statystyki ostatniej, trwajÄ…cej sekcji.